<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
     integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
       <link rel="stylesheet" href="admission.css?v=<?php echo time(); ?>">
    <title>Document</title>
    <script>
    if(window.history.replaceState){
        window.history.replaceState(null,null,window.location.href);
    }

   
    </script>
</head>
<body>
   
<div id="navbar"><img src="ganga.png" alt="">
        <div id="navbarcontent">
    <a href="#">CREDITS</a>
<a href="#">GANGA HOSPITALS</a>

<a href="firstpage.php"><i class="fa fa-fast-backward"></i>&nbsp;&nbsp;&nbsp;HOME</a></div></div>

  <table id="mytable" cellpadding="10">

  
  <h1>FLOOR-1 </h1>
<tr>

<th><em>SPECIAL<br>WARDS</em>  </th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
  <tr>
      <th></th>
      <th><h6>ROOM_A1</h6></th>
      <th></th>
      <th><h6>ROOM_A2</h6></th>
<th></th>
    </tr>
    <tr>
      <td></td>
    <td><i id="FLOOR-1 ROOM_A1 1"  class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-1 ROOM_A1 1"  form="specialward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-1 ROOM_A1 1"  form="specialward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>

<td></td>

       <td><i id="FLOOR-1 ROOM_A2 1"   class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-1 ROOM_A2 1" form="specialward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-1 ROOM_A2 1" form="specialward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>
      <td></td>
    </tr>
<tr>
<th><em>GENERAL WARD</em></th>
</tr>
<tr>
       <td><i id="FLOOR-1 GENw 1" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-1 GENw 1"form="generalward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-1 GENw 1"form="generalward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>

         <td><i id="FLOOR-1 GENw 2" class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-1 GENw 2"form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-1 GENw 2"form="generalward-form1">Remove</button> </span>    
        <br> 2</i>
       
      </td>

           <td><i id="FLOOR-1 GENw 3" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-1 GENw 3"form="generalward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-1 GENw 3"form="generalward-form1">Remove</button> </span>    
        <br> 3</i>
       
      </td>

            <td><i id="FLOOR-1 GENw 4" class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-1 GENw 4" form="generalward-form1">Add</button> 
               <button type="submit" name="delete"value="FLOOR-1 GENw 4" form="generalward-form1">Remove</button> </span>    
        <br> 4</i>
       
      </td>
      <td></td>
</tr> 
     <tr>  
           <td><i id="FLOOR-1 GENw 5"class="fas fa-bed"><br>
        <span><button type="submit" name="submit"   value="FLOOR-1 GENw 5" form="generalward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-1 GENw 5"form="generalward-form1">Remove</button> </span>    
        <br> 5</i>
       
      </td>

        
           <td><i id="FLOOR-1 GENw 6" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-1 GENw 6" form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-1 GENw 6" form="generalward-form1">Remove</button> </span>    
        <br> 6</i>
       
      </td>

        
            <td><i id="FLOOR-1 GENw 7"  class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-1 GENw 7" form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-1 GENw 7"  form="generalward-form1">Remove</button> </span>    
        <br> 7</i>
       
      </td>

        
           <td><i id="FLOOR-1 GENw 8"  class="fas fa-bed"><br>
        <span><button type="submit" name="submit"value="FLOOR-1 GENw 8" form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-1 GENw 8"  form="generalward-form1">Remove</button> </span>    
        <br> 8</i>
       
      </td>
      <td></td>
</tr>

<tr ><th></th>
<th></th>
<th style="font-family:Garamond ;letter-spacing:5px;font-weight:800;">ICU WARD</th>
<th></th>
<th></th>
</tr>

<tr style="border:3px solid white;">
<td></td>
<td></td>
<td style="background-color:#98B4D4"><i id="FLOOR-1 ICUw 1" style="border:5px solid white;" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"value="FLOOR-1 ICUw 1" form="ICUward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-1 ICUw 1"  form="ICUward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>
      <td></td>
      <td></td>

</tr>
  </table>


  <h1>FLOOR-2</h1>

  <table cellpadding="10">

  <tr>

<th><em>SPECIAL<br>WARDS</em> </th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
  <tr>
      <th></th>
      <th><h6>ROOM_A1</h6></th>
      <th></th>
      <th><h6>ROOM_A2</h6></th>
<th></th>
    </tr>
    <tr>
      <td></td>
    <td><i id="FLOOR-2 ROOM_A1 1"  class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-2 ROOM_A1 1"  form="specialward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-2 ROOM_A1 1"  form="specialward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>

<td></td>

       <td><i id="FLOOR-2 ROOM_A2 1"   class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-2 ROOM_A2 1" form="specialward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-2 ROOM_A2 1" form="specialward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>
      <td></td>
    </tr>


<tr>
<th><em>GENERAL WARD</em></th>
</tr>
<tr>
       <td><i id="FLOOR-2 GENw 1" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-2 GENw 1"form="generalward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-2 GENw 1"form="generalward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>

         <td><i id="FLOOR-2 GENw 2" class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-2 GENw 2"form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-2 GENw 2"form="generalward-form1">Remove</button> </span>    
        <br> 2</i>
       
      </td>

           <td><i id="FLOOR-2 GENw 3" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-2 GENw 3"form="generalward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-2 GENw 3"form="generalward-form1">Remove</button> </span>    
        <br> 3</i>
       
      </td>

            <td><i id="FLOOR-2 GENw 4" class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-2 GENw 4" form="generalward-form1">Add</button> 
               <button type="submit" name="delete"value="FLOOR-2 GENw 4" form="generalward-form1">Remove</button> </span>    
        <br> 4</i>
       
      </td>
      <td></td>
</tr> 
     <tr>  
           <td><i id="FLOOR-2 GENw 5"class="fas fa-bed"><br>
        <span><button type="submit" name="submit"   value="FLOOR-2 GENw 5" form="generalward-form1">Add</button> 
               <button type="submit" name="delete"  value="FLOOR-2 GENw 5"form="generalward-form1">Remove</button> </span>    
        <br> 5</i>
       
      </td>

        
           <td><i id="FLOOR-2 GENw 6" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"  value="FLOOR-2 GENw 6" form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-2 GENw 6" form="generalward-form1">Remove</button> </span>    
        <br> 6</i>
       
      </td>

        
            <td><i id="FLOOR-2 GENw 7"  class="fas fa-bed"><br>
        <span><button type="submit" name="submit" value="FLOOR-2 GENw 7" form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-2 GENw 7"  form="generalward-form1">Remove</button> </span>    
        <br> 7</i>
       
      </td>

        
           <td><i id="FLOOR-2 GENw 8"  class="fas fa-bed"><br>
        <span><button type="submit" name="submit"value="FLOOR-2 GENw 8" form="generalward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-2 GENw 8"  form="generalward-form1">Remove</button> </span>    
        <br> 8</i>
       
      </td>
      <td></td>
</tr>


<tr><th></th>
<th></th>
<th style="font-family:Garamond ;letter-spacing:5px;font-weight:800;">ICU WARD</th>
<th></th>
<th></th>
</tr>

<tr style="border:3px solid white">
<td></td>
<td></td>
<td style="background-color:#98B4D4"><i id="FLOOR-2 ICUw 1" style="border:5px solid white;" class="fas fa-bed"><br>
        <span><button type="submit" name="submit"value="FLOOR-2 ICUw 1" form="ICUward-form1">Add</button> 
               <button type="submit" name="delete" value="FLOOR-2 ICUw 1"  form="ICUward-form1">Remove</button> </span>    
        <br> 1</i>
       
      </td>
      <td></td>
      <td></td>

</tr>


</table>

<form action="" id="generalward-form1" method="post">


</form>

<form action="" id="specialward-form1" method="post">

</form>
<form action="" id="ICUward-form1" method="post"></form>


<div style="position:absolute;top:40%;right:2%;border:2px solid black;padding:2%">

<h3 style="border-bottom:2px dashed black;"><i style="color:red; background: none;border:none;"  class="fas fa-bed"></i><br><br> BOOKED</h3>
<h3><i style="color:forestgreen; background: none;border:none;"  class="fas fa-bed"></i><br>AVAILABLE <br> FOR <br> BOOKING</h3>
</div>
<?php


$con = new mysqli('localhost','root','','crud');
if(!$con){
    echo "connection unsuccessful!";
}



$id = $_GET['admission'];
$sql = "Select * from crudoperation where id=$id";
$result = mysqli_query($con,$sql);
$row  = mysqli_fetch_assoc($result);
$color = $row['color'];
$room  =$row['room'];
$dateOut = $row['dateOut'];
if($dateOut!=='0000-00-00 00:00:00'){
    
        echo "<script>alert('The patient has discharged cannot book anyMore!');
        window.location.href = 'firstpage.php';
        </script>";
              

}else{
if(isset( $_POST['submit'])){

  $id = $_GET['admission'];
$rooms=$_POST['submit'];
$ICU = "ICUw";
 $sqlee = "Select * from crudoperation where id='$id'";
 $checkbook = "Select * from crudoperation where id='$id' and booked_or_not = 'booked'";
 $combinecheck = mysqli_query($con,$checkbook);
 if(mysqli_num_rows($combinecheck)>=1){
echo "<script>alert('Bed is already booked for this patient');</script>";



 }else{


    $checkbook2 = "Select * from crudoperation where room='$rooms'";
 $combinecheck2 = mysqli_query($con,$checkbook2);
  if(mysqli_num_rows($combinecheck2)>=1){
echo "<script>alert('This bed has booked by other patient');</script>";



 }else{
    $combine = mysqli_query($con,$sqlee);
 if($combine){
 $result = mysqli_num_rows($combine);
  if($result>=1){
$sql = "update crudoperation set room = '$rooms', booked_or_not='booked', color='red' where id=$id";

$result = mysqli_query($con,$sql);
if($result){
   
  print "<script>
  let y = '$rooms';
    document.getElementById(y).style.color = 'red';
    document.getElementById(y).style.boxShadow = '0 0 10px red';
    alert('Allotment successful'); 
 </script>";
}else{
    echo die(mysqli_error($con));
}
 }else{
   echo "Patient does not exist";
 }
}else{
    echo die(mysqli_error($con));
}
 }
 
}
}

}
if(isset( $_POST['delete'])){
  $delete = $_POST['delete'];
  $id = $_GET['admission'];
$sql = "Select * from crudoperation where id=$id";
$result = mysqli_query($con,$sql);
$row  = mysqli_fetch_assoc($result);
$color = $row['color'];
$booked_or_not = $row['booked_or_not'];
$rooms= $row['room'];
if($delete==$rooms){
$sqlii = "update crudoperation set room='',booked_or_not='Not booked',color = '' where id=$id";
$resultii = mysqli_query($con,$sqlii);
if($resultii){
       echo "<script>alert('Bed removed')
       let y = '$rooms';
    document.getElementById(y).style.color = 'black';
    
    document.getElementById(y).style.boxShadow = '0 0 10px grey' ;</script>";
       
  


}
}else{
  echo "<script>alert('This is not the right bed');</script>";
}
}
    ?>


<script>
 document.getElementById('<?=$room?>').style.color = '<?=$color?>';
  document.getElementById('<?=$room?>').style.boxShadow = '0 0 10px <?=$color?>';
</script>
  
</body>
</html>
